<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ECMAScript历代版本特性 - ES11(2020) | Vic的博客</title>
    <meta name="description" content="Vic,preson,日常开发记录,语言准备,Edmonton">
    <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="icon" href="./images/logo.gif">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.132b0d4b.css" as="style"><link rel="preload" href="/assets/js/app.3e56524b.js" as="script"><link rel="preload" href="/assets/js/49.58b0bfdd.js" as="script"><link rel="preload" href="/assets/js/8.7f11c8af.js" as="script"><link rel="prefetch" href="/assets/js/10.b9735447.js"><link rel="prefetch" href="/assets/js/11.0d6f5dc9.js"><link rel="prefetch" href="/assets/js/12.e4d845cf.js"><link rel="prefetch" href="/assets/js/13.712197c9.js"><link rel="prefetch" href="/assets/js/14.b14e6c26.js"><link rel="prefetch" href="/assets/js/15.bda3ed3b.js"><link rel="prefetch" href="/assets/js/16.c2cc75dd.js"><link rel="prefetch" href="/assets/js/17.abe296f5.js"><link rel="prefetch" href="/assets/js/18.a2542d1a.js"><link rel="prefetch" href="/assets/js/19.b1235c9b.js"><link rel="prefetch" href="/assets/js/2.51a4babd.js"><link rel="prefetch" href="/assets/js/20.4282b08d.js"><link rel="prefetch" href="/assets/js/21.ef90e696.js"><link rel="prefetch" href="/assets/js/22.4b9752d2.js"><link rel="prefetch" href="/assets/js/23.7965b2e8.js"><link rel="prefetch" href="/assets/js/24.7144c9af.js"><link rel="prefetch" href="/assets/js/25.346cb919.js"><link rel="prefetch" href="/assets/js/26.b56ede3d.js"><link rel="prefetch" href="/assets/js/27.48d371f7.js"><link rel="prefetch" href="/assets/js/28.3e09139b.js"><link rel="prefetch" href="/assets/js/29.1aa5a3c0.js"><link rel="prefetch" href="/assets/js/3.6537c304.js"><link rel="prefetch" href="/assets/js/30.b267c7a0.js"><link rel="prefetch" href="/assets/js/31.9c5de5f0.js"><link rel="prefetch" href="/assets/js/32.956deabd.js"><link rel="prefetch" href="/assets/js/33.9113e4c5.js"><link rel="prefetch" href="/assets/js/34.b351426b.js"><link rel="prefetch" href="/assets/js/35.4c7963f5.js"><link rel="prefetch" href="/assets/js/36.c4ffc5cf.js"><link rel="prefetch" href="/assets/js/37.aadfeccc.js"><link rel="prefetch" href="/assets/js/38.ff81dbec.js"><link rel="prefetch" href="/assets/js/39.d0f4152f.js"><link rel="prefetch" href="/assets/js/4.2921848a.js"><link rel="prefetch" href="/assets/js/40.022ae3a6.js"><link rel="prefetch" href="/assets/js/41.25d70280.js"><link rel="prefetch" href="/assets/js/42.3aa133aa.js"><link rel="prefetch" href="/assets/js/43.25b92b3a.js"><link rel="prefetch" href="/assets/js/44.27d9059e.js"><link rel="prefetch" href="/assets/js/45.2da90f94.js"><link rel="prefetch" href="/assets/js/46.13b2b1b8.js"><link rel="prefetch" href="/assets/js/47.5b5d9388.js"><link rel="prefetch" href="/assets/js/48.8a5dcf3e.js"><link rel="prefetch" href="/assets/js/5.db4be22f.js"><link rel="prefetch" href="/assets/js/50.393cc386.js"><link rel="prefetch" href="/assets/js/51.3df91732.js"><link rel="prefetch" href="/assets/js/52.8784d899.js"><link rel="prefetch" href="/assets/js/53.12b9e9a7.js"><link rel="prefetch" href="/assets/js/54.fa254d1d.js"><link rel="prefetch" href="/assets/js/55.ff70833f.js"><link rel="prefetch" href="/assets/js/56.0f49028f.js"><link rel="prefetch" href="/assets/js/57.1059462c.js"><link rel="prefetch" href="/assets/js/58.4128750e.js"><link rel="prefetch" href="/assets/js/59.b0325ec7.js"><link rel="prefetch" href="/assets/js/6.52af3c62.js"><link rel="prefetch" href="/assets/js/60.0b9439a1.js"><link rel="prefetch" href="/assets/js/61.2c5b15a1.js"><link rel="prefetch" href="/assets/js/62.6eb1a621.js"><link rel="prefetch" href="/assets/js/63.da11ee8f.js"><link rel="prefetch" href="/assets/js/64.849a2525.js"><link rel="prefetch" href="/assets/js/65.0ee0faaf.js"><link rel="prefetch" href="/assets/js/66.cb34d58f.js"><link rel="prefetch" href="/assets/js/67.d54b422a.js"><link rel="prefetch" href="/assets/js/68.7d269019.js"><link rel="prefetch" href="/assets/js/69.84da84e7.js"><link rel="prefetch" href="/assets/js/7.78906fc9.js"><link rel="prefetch" href="/assets/js/70.2b9bfcbe.js"><link rel="prefetch" href="/assets/js/71.406b74b3.js"><link rel="prefetch" href="/assets/js/72.480ff203.js"><link rel="prefetch" href="/assets/js/73.dbbac51a.js"><link rel="prefetch" href="/assets/js/74.f833cba4.js"><link rel="prefetch" href="/assets/js/75.afd6b113.js"><link rel="prefetch" href="/assets/js/76.43da6b21.js"><link rel="prefetch" href="/assets/js/77.513b6b14.js"><link rel="prefetch" href="/assets/js/78.2ac7f15b.js"><link rel="prefetch" href="/assets/js/79.6d81e646.js"><link rel="prefetch" href="/assets/js/80.228826e4.js"><link rel="prefetch" href="/assets/js/81.a08895c6.js"><link rel="prefetch" href="/assets/js/82.ac414c3c.js"><link rel="prefetch" href="/assets/js/83.49a71d38.js"><link rel="prefetch" href="/assets/js/84.a481e438.js"><link rel="prefetch" href="/assets/js/85.8d623689.js"><link rel="prefetch" href="/assets/js/86.994129b9.js"><link rel="prefetch" href="/assets/js/87.87c6db43.js"><link rel="prefetch" href="/assets/js/88.5689a53a.js"><link rel="prefetch" href="/assets/js/89.e7428311.js"><link rel="prefetch" href="/assets/js/9.ef6f5b3b.js"><link rel="prefetch" href="/assets/js/90.497d587a.js"><link rel="prefetch" href="/assets/js/91.dee61449.js"><link rel="prefetch" href="/assets/js/92.7351c800.js"><link rel="prefetch" href="/assets/js/93.aa08fafd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.132b0d4b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Vic的博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/blog/nodeJS/koa.html" class="nav-link">Node.js</a></div><div class="nav-item"><a href="/blog/ui/sass.html" class="nav-link">UI</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/javascript/basic/array.html" class="nav-link">常用功能记录</a></li><li class="dropdown-item"><!----> <a href="/blog/javascript/upper/eventBus.html" class="nav-link">js进阶</a></li><li class="dropdown-item"><!----> <a href="/blog/javascript/algorithm/1.html" class="nav-link">常用算法</a></li><li class="dropdown-item"><!----> <a href="/blog/javascript/extend/code.html" class="nav-link">拓展阅读</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">source Code</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/source/vue/compiler.html" class="nav-link">Vue.js</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/blog/nodeJS/koa.html" class="nav-link">Node.js</a></div><div class="nav-item"><a href="/blog/ui/sass.html" class="nav-link">UI</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/javascript/basic/array.html" class="nav-link">常用功能记录</a></li><li class="dropdown-item"><!----> <a href="/blog/javascript/upper/eventBus.html" class="nav-link">js进阶</a></li><li class="dropdown-item"><!----> <a href="/blog/javascript/algorithm/1.html" class="nav-link">常用算法</a></li><li class="dropdown-item"><!----> <a href="/blog/javascript/extend/code.html" class="nav-link">拓展阅读</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">source Code</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/source/vue/compiler.html" class="nav-link">Vue.js</a></li></ul></div></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content"><h1 id="ecmascript历代版本特性-es11-2020"><a href="#ecmascript历代版本特性-es11-2020" class="header-anchor">#</a> ECMAScript历代版本特性 - ES11(2020)</h1> <h2 id="链式运算符"><a href="#链式运算符" class="header-anchor">#</a> <code>链式运算符 ?.</code></h2> <p><strong>链合并运算符</strong>，在调用的时候判断左侧的对象是否为<strong>null或undefined</strong>。如果是的，就不再往下运算，而是返回<strong>undefined</strong>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 错误写法，当某一层级值为null或undefined时，会报错</span>
<span class="token keyword">const</span> userName <span class="token operator">=</span> list<span class="token punctuation">.</span>info<span class="token punctuation">.</span>base<span class="token punctuation">.</span>userName<span class="token punctuation">;</span>
<span class="token comment">// 正确写法（我们常用的方式）</span>
<span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token punctuation">(</span>list <span class="token operator">&amp;&amp;</span> list<span class="token punctuation">.</span>info <span class="token operator">&amp;&amp;</span> list<span class="token punctuation">.</span>info<span class="token punctuation">.</span>base <span class="token operator">&amp;&amp;</span> list<span class="token punctuation">.</span>info<span class="token punctuation">.</span>base<span class="token punctuation">.</span>userName<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">'userName'</span><span class="token punctuation">;</span>

<span class="token comment">// obj?.prop</span>
<span class="token keyword">let</span> list <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">info</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// base: {</span>
    <span class="token comment">//     userName: 'eyunhua'</span>
    <span class="token comment">// }</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> userName <span class="token operator">=</span> list<span class="token operator">?.</span>info<span class="token operator">?.</span>base<span class="token operator">?.</span>userName <span class="token operator">||</span> <span class="token string">'userName'</span><span class="token punctuation">;</span> <span class="token comment">// 判断?.左侧表达式是否为null或undefined，否，则继续往下运算</span>

<span class="token comment">// func?.(...args)</span>
funtion <span class="token function">register</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token string">'register function'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>register<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// register函数存在，则执行此函数，并且可传参</span>

<span class="token comment">// obj?.\[expr\]</span>
<span class="token keyword">let</span> hex <span class="token operator">=</span> <span class="token string">&quot;#C0FFEE&quot;</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">#([A-Z]+)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token operator">?.</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="null判断运算符"><a href="#null判断运算符" class="header-anchor">#</a> <code>Null判断运算符 ??</code></h2> <p><strong>||</strong> 或运算符表达的意思是左侧表达式为<code>null、undefined、''、false、0，</code>右侧表达式都会生效。但我们想要的只是在<code>null或undefined</code>的时候生效。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// object</span>
<span class="token keyword">const</span> userName <span class="token operator">=</span> list<span class="token operator">?.</span>info<span class="token operator">?.</span>base<span class="token operator">?.</span>userName <span class="token operator">??</span> <span class="token string">'userName'</span><span class="token punctuation">;</span>

<span class="token comment">// function</span>
<span class="token function">register</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  b <span class="token operator">=</span> b <span class="token operator">??</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意:</p> <ul><li><code>与&amp;&amp;、||运算符一起使用时，需要用括号来表明优先级，要不会报错。优先执行括号括起来的部分</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 错误</span>
a <span class="token operator">&amp;&amp;</span> b <span class="token operator">??</span> c
<span class="token comment">// 正确</span>
<span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> b<span class="token punctuation">)</span> <span class="token operator">??</span> c
</code></pre></div><h2 id="动态导入模块-import"><a href="#动态导入模块-import" class="header-anchor">#</a> <code>动态导入模块 import()</code></h2> <p>用法: <code>import(fileName.js)</code></p> <ul><li><strong>import</strong>命令会被 <strong>JavaScript</strong> 引擎静态分析，先于模块内的其他语句执行。引擎处理<strong>import</strong>语句是在编译时，而不是运行时。也就是说<strong>import和export</strong>命令只能在模块的顶层，而不能在代码块中。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 报错</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>page <span class="token operator">===</span> <span class="token string">'home'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">'./home'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>import()<strong>函数返回一个</strong>Promise</strong>对象，加载模块成功以后，这个模块会作为一个对象，当作<strong>then</strong>回调的参数。因此，可以使用对象解构赋值的语法，获取输出接口。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./home.js</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>  <span class="token comment">// home.js中export const export1 = ''; ....</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>export1<span class="token punctuation">,</span> export2<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> 
    <span class="token comment">// 加载成功的回调</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 加载失败的回调</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>import()是运行时执行</strong>，也就是说，<strong>什么时候运行到这一句，就会加载指定的模块</strong>。另外，<strong>import()函数与所加载的模块没有静态连接关系</strong>，这点也是与import语句不相同。
<strong>import()<strong>类似于Node的</strong>require</strong>方法，区别主要是前者是异步加载，后者是同步加载。</li></ul> <p>使用场景:</p> <blockquote><ul><li><strong>按需加载（比如点击时加载某个文件或者模块）</strong></li> <li><strong>条件加载（比如if判断模块中）</strong></li> <li><strong>动态的模块路径（比如模块路径是实时生成）</strong></li></ul></blockquote> <h2 id="export-as-ns-from-module"><a href="#export-as-ns-from-module" class="header-anchor">#</a> <code>export * as ns from 'module'</code></h2> <p>含义：<code>在一个模块内，先输入模块再输出模块， import语句可与export语句写在一起。</code></p> <p>注意:   <strong>写在一行后，实际上并没有导入接口，只是对接口进行了转发，导致在当前模块不能使用此接口。</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">as</span> someIdentifier <span class="token keyword">from</span> <span class="token string">&quot;someModule&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ns <span class="token keyword">from</span> <span class="token string">&quot;mod&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>ns<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="bigint"><a href="#bigint" class="header-anchor">#</a> <code>BigInt</code></h2> <p>含义: <strong>一个用于处理任意精度整数的新数字基元</strong>, JavaScript 所有<strong>数字都保存成 64 位浮点数</strong>，这给数值的表示带来了两大限制:</p> <ul><li><p>数值的精度：只能到 <strong>53 个二进制位（相当于 16 个十进制位）</strong>，大于这个范围的整数，JavaScript 是无法精确表示的。</p></li> <li><p>大于或等于<strong>2的1024次方</strong>的数值，JavaScript 无法表示，会返回<strong>Infinity</strong>。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 超过 53 个二进制位的数值，无法保持精度</span>
Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">)</span> <span class="token operator">===</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token comment">// true</span>

<span class="token comment">// 超过 2 的 1024 次方的数值，无法表示</span>
Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token comment">// Infinity</span>
</code></pre></div><p>为了更精确地表示没有位数限制的整数，ES2020引入了不同于<strong>Number数字类型的BigInt数字类型， 只用来表示整数（大整数），没有位数的限制</strong>，任何位数的整数都可以精确表示。为了与 Number 类型区别，<strong>BigInt 类型的数据必须添加后缀n</strong>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">2172141653n</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">15346349309n</span><span class="token punctuation">;</span>

<span class="token keyword">typeof</span> a <span class="token operator">==</span> <span class="token string">'bigint'</span> <span class="token comment">//true</span>
<span class="token function">Number</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 1231201</span>

<span class="token comment">// BigInt 可以保持精度</span>
a <span class="token operator">*</span> b <span class="token comment">// 33334444555566667777n</span>

<span class="token comment">// 普通整数无法保持精度</span>
<span class="token function">Number</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">Number</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// 33334444555566670000</span>
</code></pre></div><p>JavaScript 原生提供<strong>BigInt</strong>对象，可以用作构造函数生成 <strong>BigInt</strong> 类型的数值。<code>转换规则基本与Number()一致，将其他类型的值转为 BigInt</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token comment">// 123n</span>
<span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span> <span class="token comment">// 123n</span>
<span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 0n</span>
<span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 1n</span>
</code></pre></div><p><strong>BigInt</strong>相关api</p> <ul><li><p><strong>BigInt.prototype.toString()</strong></p></li> <li><p><strong>BigInt.prototype.valueOf()</strong></p></li> <li><p><strong>BigInt.prototype.toLocaleString()</strong></p></li> <li><p><strong>BigInt.asUintN(width, BigInt)</strong></p> <p>给定的 BigInt 转为 0 到 2width - 1 之间对应的值。</p></li> <li><p><strong>BigInt.asIntN(width, BigInt)</strong></p> <p>给定的 BigInt 转为 -2width - 1 到 2width - 1 - 1 之间对应的值。</p></li> <li><p><strong>BigInt.parseInt(string[, radix])</strong></p> <p>近似于Number.parseInt()，将一个字符串转换成指定进制的</p></li></ul> <h2 id="promise-allsettled"><a href="#promise-allsettled" class="header-anchor">#</a> <code>Promise.allSettled()</code></h2> <p>用法: 接受<strong>一组Promise</strong> 实例作为参数，包装成一个新的 <strong>Promise</strong> 实例。只有等到所有这些参数实例都返回结果，不管是<strong>fulfilled</strong>还是<strong>rejected</strong>，包装实例才会结束，一旦结束，状态总是 <strong>fulfilled</strong>，不会变成rejected。状态变成<strong>fulfilled</strong>后，<strong>Promise</strong> 的监听函数接收到的参数是一个数组，每个成员对应一个传入**Promise.allSettled()**的 Promise 实例。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> resolved <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> rejected <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> allSettledPromise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">allSettled</span><span class="token punctuation">(</span><span class="token punctuation">[</span>resolved<span class="token punctuation">,</span> rejected<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

allSettledPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [{ status: 'fulfilled', value: 42 },  { status: 'rejected', reason: -1 }]</span>
</code></pre></div><p>监听函数接收到的数组，每个成员都是一个对象，对应传入<strong>Promise.allSettled()<strong>的两个 <strong>Promise</strong> 实例。每个对象都有</strong>status</strong>属性，该属性的值只可能是字符串<strong>fulfilled</strong>或字符串<strong>rejected</strong>。fulfilled时，对象有value属性，<strong>rejected时有reason</strong>属性，对应两种状态的返回值。</p> <h3 id="对比promise-all"><a href="#对比promise-all" class="header-anchor">#</a> 对比Promise.all</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> result<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'报错了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> result<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'p2:'</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//p2:Error: 报错了</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">const</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//['hello', undefined]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'settled:'</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="对比promise-race"><a href="#对比promise-race" class="header-anchor">#</a> 对比Promise.race</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'成功了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> race <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p3<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'request timeout'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

race<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success:'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error: Error: request timeout</span>
</code></pre></div><h3 id="allsettled-race-all的区别"><a href="#allsettled-race-all的区别" class="header-anchor">#</a> allSettled,race,all的区别</h3> <p>不同点：</p> <ul><li><strong>状态</strong></li></ul> <p><strong>Promise.all</strong> <br>
p1和p2实例状态都为fulfilled时，p的状态才会变成fulfilled，此时p1、p2的返回值组成一个数组，传递给p的回调函数
只要p1、p2之中有一个被rejected，p的状态就变成rejected，此时第一个被reject的实例的返回值，会传递给p的回调函数</p> <p><strong>Promise.allSettled</strong> <br>
一旦结束，状态总是fulfilled，不会变成rejected（也就是永远进不到p的catch回调）。</p> <p><strong>Promise.race</strong> <br>
其中一实例返回状态，p的状态就会发生改变，并且不会再变</p> <ul><li><strong>返回值</strong></li></ul> <p><strong>Promise.all</strong> <br>
返回数组，每一个成员都是实例对应的结果  <br></p> <p><strong>Promise.allSettled</strong> <br>
返回数组，数组的每一个成员都是对象，每个对象都有status属性，该属性的值只可能是字符串fulfilled或字符串rejected。fulfilled时，对象有value属性，rejected时有reason属性，对应两种状态的返回值.</p> <p><strong>Promise.race</strong> <br>
每一个实例对应的结果</p> <ul><li><strong>应用场景</strong></li></ul> <p><strong>Promise.all</strong> <br>
参数Promise实例中是否有被reject的实例，无法确定所有请求都已结束</p> <p><strong>Promise.allSettled</strong> <br>
可以确定所有请求都已结束</p> <p><strong>Promise.race</strong> <br>
只要有返回值，立马停止其他请求</p> <h2 id="string-prototype-matchall"><a href="#string-prototype-matchall" class="header-anchor">#</a> <code>String.prototype.matchAll()</code></h2> <p>用法: 返回一个正则表达式在当前字符串中所有的匹配</p> <p>es2020前版本</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> regex <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">t(e)(st(\d?))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token string">'test1test2test3'</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> matches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> match<span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>match <span class="token operator">=</span> regex<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  matches<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>match<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>matches<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// [['test1', 'e', 'st1', '1', index: 0, input: 'test1test2test3', groups: undefined]，</span>
<span class="token comment">// ['test2', 'e', 'st2', '2', index: 5, input: 'test1test2test3', groups: undefined]</span>
<span class="token comment">// ['test3', 'e', 'st3', '3', index: 10, input: 'test1test2test3', groups: undefined]]</span>

</code></pre></div><p>ES2020新增matchAll新特性</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> regex <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">t(e)(st(\d?))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token string">'test1test2test3'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>string<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [['test1', 'e', 'st1', '1', index: 0, input: 'test1test2test3', groups: undefined] , Array(4), Array(4)]</span>
<span class="token comment">// or</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//[['test1', 'e', 'st1', '1', index: 0, input: 'test1test2test3', groups: undefined], Array(4), Array(4)]</span>
</code></pre></div><h2 id="globalthis"><a href="#globalthis" class="header-anchor">#</a> <code>globalThis</code></h2> <p>作用: 一种在不同环境中获取顶层对象的通用方式</p> <p>不同环境中获取全局对象的方法不同 <br>
浏览器里面，顶层对象是window，但 <strong>Node 和 Web Worker 没有window</strong>。 <br>
浏览器 和 <strong>Web Worker</strong>里面，<strong>self</strong>也指向顶层对象，但是 <strong>Node 没有self</strong>。 <br>
Node 里面，顶层对象是<strong>global</strong>，但其他环境都不支持</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方法一</span>
<span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token operator">?</span> 
    <span class="token literal-property property">window</span><span class="token operator">:</span><span class="token punctuation">(</span>
      <span class="token keyword">typeof</span> process <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span>
      <span class="token keyword">typeof</span> require <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span>
      <span class="token keyword">typeof</span> global <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span>
     <span class="token operator">?</span> global <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 方法二</span>
<span class="token keyword">var</span> <span class="token function-variable function">getGlobal</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> self <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> self<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> window<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> global <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> global<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'unable to locate global object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 方法三： globalThis</span>
<span class="token keyword">var</span> global <span class="token operator">=</span> globalThis<span class="token punctuation">;</span>
</code></pre></div><p><p data-v-0cb7829d>
    非经营性网站备案信息 <a href="https://beian.miit.gov.cn" target="_blank" data-v-0cb7829d>蜀ICP备2022003521号-1</a></p></p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.3e56524b.js" defer></script><script src="/assets/js/49.58b0bfdd.js" defer></script><script src="/assets/js/8.7f11c8af.js" defer></script>
  </body>
</html>
